/******************************************************************************* * @title        delay_SysTick.h * * @Description  Show how to use the ARM Cortex System Tick mecanism * * 			   The method to configure the MCU to generate an SysTick event that will to handled *             by the SysTick_Handler method. A global variable is decreased/increased at each execution *             of the system tick handler method. * *   Steps: *   1) Write the appropriate code in the SysTick_Handler *      There is a template empty definition of this method in the stm32f30x_it.c file *      in each Atollic TrueStudio project. For the CooCox projects * *  2) Define a global integer that will be decremented/incremented by the handler method *     Note: if the handler method being declared in a different file than main.c, make sure *           to redeclare the counter variable as extern, otherwise the linke will fail * *  3) Have Delay method where the global counter will be set to the value to wait * *  4) Trigger the SysTick handler by setting it period as following * *          -->   SysTick_Config(SystemCoreClock / Frequency) *          Frequency is the number of time by second the handler method is to be invoked by *          the MCU. *          Example SysTick_Config(SystemCoreClock / 1000) will generate 1000 interrupts by second *  ********************************************************************************/#include "delay.h"volatile u32 tick = 0;void SysTick_Handler(void) {    tick++;}inline void delay(uint32_t time, uint32_t load) {    tick = 0;    SysTick_Config(load);    do {        while (!(SysTick->CTRL && SysTick_CTRL_COUNTFLAG_Msk));    } while (tick < time);    SysTick->CTRL = 0;}inline void delay_ms(uint32_t time) {    delay(time, SystemCoreClock / 1000);}inline void delay_us(uint32_t time) {    delay(time, SystemCoreClock / 1000000);}